# azurerm_iothub_file_upload

Manages the File Upload of an IoT Hub.~> **NOTE:** File upload can be defined either directly on the `azurerm_iothub` resource, or using the `azurerm_iothub_file_upload` resource - but the two cannot be used together. If both are used against the same IoTHub, spurious changes will occur.

## Example `component.hclt`

```hcl
source = {
   repo = "https://github.com/jumidev/terraform-modules-auto-azurerm.git"   
   path = "iot_hub/iothub_file_upload"   
}

inputs = {
   # iothub_id â†’ set in component_inputs
   connection_string = "The connection string for the Azure Storage account to which files are uploaded..."   
   container_name = "The name of the root container where the files should be uploaded to..."   
}

component_inputs = {
   iothub_id = "path/to/iothub_component:id"   
}

tfstate_store = {
   storage_account = "${storage_account}"   
   container = "${container}"   
   container_path = "${COMPONENT_PATH}"   
}

```

## Required Variables

| Name | Type |  Description |
| ---- | --------- |  ----------- |
| **iothub_id** | string |  The ID of the IoT Hub. Changing this forces a new IoT Hub to be created. | 
| **connection_string** | string |  The connection string for the Azure Storage account to which files are uploaded. | 
| **container_name** | string |  The name of the root container where the files should be uploaded to. The container need not exist but should be creatable using the `connection_string` specified. | 

## Optional Variables

| Name | Type |  Default  |  possible values |  Description |
| ---- | --------- |  ----------- | ----------- | ----------- |
| **authentication_type** | string |  `keyBased`  |  `keyBased`, `identityBased`  |  The type used to authenticate against the storage account. Possible values are `keyBased` and `identityBased`. Defaults to `keyBased`. | 
| **default_ttl** | string |  `PT1H`  |  -  |  The period of time for which a file upload notification message is available to consume before it expires, specified as an [ISO 8601 timespan duration](https://en.wikipedia.org/wiki/ISO_8601#Durations). This value must be between 1 minute and 48 hours. Defaults to `PT1H`. | 
| **identity_id** | string |  -  |  -  |  The ID of the User Managed Identity used to authenticate against the storage account. | 
| **lock_duration** | string |  `PT1M`  |  -  |  The lock duration for the file upload notifications queue, specified as an [ISO 8601 timespan duration](https://en.wikipedia.org/wiki/ISO_8601#Durations). This value must be between 5 and 300 seconds. Defaults to `PT1M`. | 
| **max_delivery_count** | number |  `10`  |  -  |  The number of times the IoT Hub attempts to deliver a file upload notification message. Defaults to `10`. | 
| **notifications_enabled** | bool |  `False`  |  -  |  Used to specify whether file notifications are sent to IoT Hub on upload. Defaults to `false`. | 
| **sas_ttl** | string |  `PT1H`  |  -  |  The period of time for which the SAS URI generated by IoT Hub for file upload is valid, specified as an [ISO 8601 timespan duration](https://en.wikipedia.org/wiki/ISO_8601#Durations). This value must be between 1 minute and 24 hours. Defaults to `PT1H`. | 



## Outputs

| Name | Type | Sensitive? | Description |
| ---- | ---- | --------- | --------- |
| **id** | string | No  | The ID of the IoT Hub. | 

Additionally, all variables are provided as outputs.
